{% extends clean_base.html %}

{% block content %}
<style>
.content{
   width:1000px;
   margin:auto;
}
.header{
   float:left;
   width:100%;
}
.header h1{
   text-align:center;
}
.body{
   width:100%;
   float:left;
   padding-top:20px;
   margin:auto;
}
.table_wrapper{
   float:left;
   width:60%;
}
table.form{
   border-spacing:10px;
   border-collapse:separate;
   margin:auto;
   align:center;
}

.sidebar{
   float:left;
   width:18%;
   padding-top:10px;
   margin-right: 40px;
}

#hive_query{
   width: 400px;
   height: 200px;
}

#comment{
   width: 400px;
   height: 200px;
}

#owner{
   width: 200px;
}
</style>

<script>
$(document).ready( function() {
  $("select[name=request_type]").change(function() {
     if (this.value == "domain_list") {
         $("label[for=target_window], input[name=target_window]").prop("disabled", false).prop("hidden", false);
	 $("label[for=segment], select[name=segment]").prop("disabled", false).prop("hidden", false);
     }

     else {
         $("label[for=target_window], input[name=target_window]").prop("disabled", true).prop("hidden", true);
	 $("label[for=segment], select[name=segment]").prop("disabled", true).prop("hidden", true);
     }

     if (this.value == "hive_query") {
         $("label[for=hive_query], textarea[name=hive_query]").prop("disabled", false).prop("hidden", false);
         $("label[for=custom_params], input[name=custom_params]").prop("disabled", false).prop("hidden", false);
     }

     else {
         $("label[for=hive_query], textarea[name=hive_query]").prop("disabled", true).prop("hidden", true);
         $("label[for=custom_params], input[name=custom_params]").prop("disabled", true).prop("hidden", true);
     }

  }).change();

  $("#custom_params").on("click", function() {
      if ($("input[name=custom_params]").is(":checked")) {
          $("input[name=expiration]").prop("disabled", true);
          $("input[name=target_segment]").prop("disabled", true);
      }
      else {
          $("input[name=expiration]").prop("disabled", false);
          $("input[name=target_segment]").prop("disabled", false);
      }
  }).triggerHandler("click");;

  $("#segment").prepend("<option value='' selected='selected'></option>");
});

</script>

<div class="content">
<div class="header">
  <h1>Batch Request Form</h1>
</div>
<div class="body">
<div class="sidebar">
  <ul>
    <li><a href="/admin/batch_request">Request form</a></li>
    <li><a href="/admin/batch_requests">Requests</a></li>
  </ul>
</div>

<div class="table_wrapper">
<form action="" method="post">
<table class="form">
<tr>
  <td><label for="request_type">Type</label></td>
  <td><select id="request_type" name="request_type">
      {% for request_type in request_types %}
      <option value="{{request_type}}">{{request_type}}</option>
      {% end %}
      </select>
  </td>
</tr>

<tr>
  <td><label for="segment">Segment</label></td>
  <td><select id="segment" name="segment">
    {% for segment in segments %}
    <option value="{{segment}}">{{segment}}</option>
    {% end %}
  </select> </td>
</tr>

<tr>
  <td><label for="hive_query">Hive Query</label></td>
  <td colspan="3"><textarea id="hive_query" name="hive_query"></textarea></td>
</tr>

<tr>
  <td><label for="target_window">Target Window (minutes)</label></td>
  <td colspan="3"><input type="text" name="target_window"></input></td>
</tr>

<tr>
  <td><label for="expiration">Expiration (minutes)</label></td>
  <td><input type="text" name="expiration"></input></td>
  <td><input type="checkbox" name="custom_params" id="custom_params"></input></td>
  <td><label for="custom_params">Specify the expiration(s) and target_segment(s) within my query</label></td>
</tr>

<tr>
  <td><label for="target_segment">Target Segment</label></td>
  <td><input type="text" name="target_segment"></input></td>
</tr>

<tr>
  <td><label for="active">Active</label></td>
  <td>
    <select name="active">
      <option value="1">Yes</option>
      <option value="0">No</option>
    </select>
  </td>
</tr>

<tr>
  <td><label for="comment">Comment</label></td>
  <td colspan="3"><textarea id="comment" type="text" name="comment" placeholder="Describe in plain english what this batch request should be doing. Example: Targets all users who have been to cnn.com in the past 20 minutes. Expires after 30 minutes."></textarea></td>
</tr>

<tr>
  <td><label for="owner">Owner (email)</label></td>
  <td><input id="owner" type="text" name="owner" placeholder="you@rockerbox.com"></input></td>
</tr>

<tr>
  <td align="center" colspan="2"><input type="submit" value="Submit"></td>
</tr>
</table>
</form>
</div>
</div>

</div>
{% end %}
