From e2d0cd9a269fe3a0f37dd0721bee12033d2a0204 Mon Sep 17 00:00:00 2001
From: Hari Shreedharan <hshreedharan@apache.org>
Date: Wed, 21 Aug 2013 23:52:15 -0700
Subject: [PATCH 29/56] FLUME-2174. Integration of morphline solr sink puts Lucene/Solr dependencies on the default classpath

(Roman Shaposhnik via Hari Shreedharan)
---
 .../flume-ng-morphline-solr-sink/pom.xml           |   65 +++++---------------
 1 files changed, 16 insertions(+), 49 deletions(-)

diff --git a/flume-ng-sinks/flume-ng-morphline-solr-sink/pom.xml b/flume-ng-sinks/flume-ng-morphline-solr-sink/pom.xml
index 4d4ca63..972c5ab 100644
--- a/flume-ng-sinks/flume-ng-morphline-solr-sink/pom.xml
+++ b/flume-ng-sinks/flume-ng-morphline-solr-sink/pom.xml
@@ -34,7 +34,7 @@ limitations under the License.
     <solr.version>4.3.0</solr.version>
     <solr.expected.version>4.3.0</solr.expected.version> <!-- sanity check to verify we actually run against the expected version rather than some outdated version -->
     <tika.version>1.3</tika.version>
-    <cdk.version>0.5.0</cdk.version>
+    <cdk.version>0.6.0</cdk.version>
     <slf4j.version>1.6.1</slf4j.version>
     <surefire.version>2.12.4</surefire.version>
   </properties>
@@ -88,6 +88,14 @@ limitations under the License.
     </dependency>
 
     <dependency>
+      <groupId>com.cloudera.cdk</groupId>
+      <artifactId>cdk-morphlines-all</artifactId>
+      <version>${cdk.version}</version>
+      <type>pom</type>
+      <optional>true</optional>
+    </dependency>
+
+    <dependency>
       <groupId>org.slf4j</groupId>
       <artifactId>jcl-over-slf4j</artifactId>
       <version>${slf4j.version}</version> <!-- flume provides 1.7.2 and solr depends on 1.6.4 -->
@@ -99,48 +107,19 @@ limitations under the License.
       <artifactId>solr-test-framework</artifactId>
       <version>${solr.version}</version>
       <scope>test</scope>
-    </dependency>
-
-    <dependency>
-      <groupId>com.cloudera.cdk</groupId>
-      <artifactId>cdk-morphlines-solr-cell</artifactId>
-      <version>${cdk.version}</version>
-    </dependency>
-
-    <dependency>
-      <groupId>com.cloudera.cdk</groupId>
-      <artifactId>cdk-morphlines-avro</artifactId>
-      <version>${cdk.version}</version>
-    </dependency>
-
-    <dependency>
-      <groupId>com.cloudera.cdk</groupId>
-      <artifactId>cdk-morphlines-json</artifactId>
-      <version>${cdk.version}</version>
-    </dependency>
-
-    <dependency>
-      <groupId>com.cloudera.cdk</groupId>
-      <artifactId>cdk-morphlines-twitter</artifactId>
-      <version>${cdk.version}</version>
-    </dependency>
-
-    <dependency>
-      <groupId>com.cloudera.cdk</groupId>
-      <artifactId>cdk-morphlines-tika-core</artifactId>
-      <version>${cdk.version}</version>
-    </dependency>
-
-    <dependency>
-      <groupId>com.cloudera.cdk</groupId>
-      <artifactId>cdk-morphlines-tika-decompress</artifactId>
-      <version>${cdk.version}</version>
+      <exclusions>
+        <exclusion>
+          <groupId>org.slf4j</groupId>
+          <artifactId>slf4j-jdk14</artifactId> <!-- instead use slf4j on top of log4j or logback  -->
+        </exclusion>
+      </exclusions>
     </dependency>
 
     <dependency> <!-- see http://tika.apache.org -->
       <groupId>org.apache.tika</groupId>
       <artifactId>tika-xmp</artifactId>
       <version>${tika.version}</version>
+      <scope>test</scope>
       <exclusions>
         <exclusion>
           <groupId>org.apache.geronimo.specs</groupId>
@@ -161,18 +140,6 @@ limitations under the License.
       <scope>test</scope>
     </dependency>
 
-    <dependency> <!-- see http://lucene.apache.org/solr -->
-      <groupId>org.apache.solr</groupId>
-      <artifactId>solr-core</artifactId>
-      <version>${solr.version}</version>
-      <exclusions>
-        <exclusion>
-          <groupId>org.slf4j</groupId>
-          <artifactId>slf4j-jdk14</artifactId> <!-- instead use slf4j on top of log4j or logback  -->
-        </exclusion>
-      </exclusions>
-    </dependency>
-
     <dependency>
       <groupId>junit</groupId>
       <artifactId>junit</artifactId>
-- 
1.7.0.4

